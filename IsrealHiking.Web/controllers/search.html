<div ng-switch on="state">
    <div ng-switch-when="Hidden" class="leaflet-bar">
        <a class="cursor-pointer" ng-click="setState('Regular', $event)" uib-tooltip="{{resources.search}}" tooltip-placement="left" tooltip-append-to-body="true"><i class="fa fa-search fa-lg"></i></a>
    </div>
    <div ng-switch-when="Regular" class="leaflet-bar" tabindex="0">
        <div uib-dropdown is-open="state == 'Regular' && fromContext.searchResults.length > 0" auto-close="disabled" ng-keydown="keyDown(fromContext, $event)" class="search-dropdown-container">
            <a class="cursor-pointer search-icon-first" ng-click="setState('Hidden', $event)"><i class="fa fa-search fa-lg"></i></a>
            <input type="text" class="search-input" ng-model="fromContext.searchTerm" ng-change="search(fromContext)" placeholder="{{resources.searchPlaceHolder}}" dir="{{getDirection(fromContext.searchTerm)}}" ng-click="ignoreClick($event)" disable-map-movement/> <!--HM TODO: sync-focus-with="isShowingSearch"-->
            <ul class="dropdown-menu dropdown-list" uib-dropdown-menu ng-click="$event.stopPropagation()">
                <li ng-repeat="result in fromContext.searchResults" dir="{{getDirection(result.name)}}" class="{{getTextAlignment(result.name)}} dropdown-item cursor-pointer" ng-class="{'search-results-selected': result == fromContext.highlightedSearchResults}" ng-click="selectResults(fromContext, result, $event)">
                    <img ng-src="{{result.icon}}" height="16" width="16" ng-show="result.icon" alt="" />
                    {{result.displayName}}
                </li>
            </ul>
            <a class="cursor-pointer search-icon-last" ng-click="setState('Directional', $event)"><i class="fa fa-plus fa-lg"></i></a>
        </div>
    </div>
    <div ng-switch-when="Directional" tabindex="0">
        <div uib-dropdown is-open="state == 'Directional' && fromContext.searchResults.length > 0 && !fromContext.selectedSearchResults" auto-close="disabled" ng-keydown="keyDown(fromContext, $event)" class="search-dropdown-container leaflet-bar">
            <a class="cursor-pointer search-icon-first" ng-click="setState('Hidden', $event)"><i class="fa fa-search fa-lg"></i></a>
            <div class="search-input search-input-directional" ng-show="fromContext.selectedSearchResults" ng-click="fromContext.selectedSearchResults = null" dir="{{getDirection(fromContext.selectedSearchResults.name)}}">
                <span><i class="fa fa-remove"></i> {{fromContext.selectedSearchResults.displayName}}</span>
            </div>
            <input type="text" class="search-input" ng-model="fromContext.searchTerm" ng-change="search(fromContext)" placeholder="{{resources.from}}" dir="{{getDirection(fromContext.searchTerm)}}" ng-click="ignoreClick($event)" ng-hide="fromContext.selectedSearchResults" disable-map-movement/> <!--HM TODO: sync-focus-with="isShowingSearch"-->
            <ul class="dropdown-menu dropdown-list" uib-dropdown-menu ng-click="$event.stopPropagation()">
                <li ng-repeat="result in fromContext.searchResults" dir="{{getDirection(result.name)}}" class="{{getTextAlignment(result.name)}} dropdown-item cursor-pointer" ng-class="{'search-results-selected': result == fromContext.highlightedSearchResults}" ng-click="selectResults(fromContext, result, $event)">
                    <img ng-src="{{result.icon}}" height="16" width="16" ng-show="result.icon" alt="" />
                    {{result.displayName}}
                </li>
            </ul>
            <a class="cursor-pointer search-icon-last" ng-click="setState('Regular', $event)"><i class="fa fa-minus fa-lg"></i></a>
        </div>
        <br />
        <div uib-dropdown is-open="state == 'Directional' && toContext.searchResults.length > 0 && !toContext.selectedSearchResults" auto-close="disabled" ng-keydown="keyDown(toContext, $event)" class="search-dropdown-container leaflet-bar">
            <a class="search-icon-first"><i class="fa fa-search fa-lg"></i></a>
            <div class="search-input search-input-directional" ng-show="toContext.selectedSearchResults" ng-click="toContext.selectedSearchResults = null" dir="{{getDirection(toContext.selectedSearchResults.name)}}">
                <span><i class="fa fa-remove"></i> {{toContext.selectedSearchResults.displayName}}</span>
            </div>
            <input type="text" class="search-input" ng-model="toContext.searchTerm" ng-change="search(toContext)" placeholder="{{resources.to}}" dir="{{getDirection(toContext.searchTerm)}}" ng-click="ignoreClick($event)" ng-hide="toContext.selectedSearchResults" disable-map-movement/> <!--HM TODO: sync-focus-with="isShowingSearch"-->
            <ul class="dropdown-menu dropdown-list" uib-dropdown-menu ng-click="$event.stopPropagation()">
                <li ng-repeat="result in toContext.searchResults" dir="{{getDirection(result.name)}}" class="{{getTextAlignment(result.name)}} dropdown-item cursor-pointer" ng-class="{'search-results-selected': result == toContext.highlightedSearchResults}" ng-click="selectResults(toContext, result, $event)">
                    <img ng-src="{{result.icon}}" height="16" width="16" ng-show="result.icon" alt="" />
                    {{result.displayName}}
                </li>
            </ul>
            <a class="cursor-pointer search-icon-last" ng-click="searchRoute($event)"><i class="fa fa-arrow-left fa-lg"></i></a>
        </div>
        <br/>
        <div class="pull-left leaflet-bar search-routing-directional">
            <a class="cursor-pointer pull-left" ng-click="setRouting('Hike', $event)" ng-class="{'leaflet-active' : routingType == 'Hike' }" uib-tooltip="{{resources.hikeRouting}}" tooltip-placement="bottom" tooltip-append-to-body="true"><img src="content/images/hike.svg" alt="" /></a>
            <a class="cursor-pointer pull-left" ng-click="setRouting('Bike', $event)" ng-class="{'leaflet-active' : routingType == 'Bike' }" uib-tooltip="{{resources.bikeRouting}}" tooltip-placement="bottom" tooltip-append-to-body="true"><img src="content/images/bike.svg" alt="" /></a>
            <a class="cursor-pointer pull-left" ng-click="setRouting('4WD', $event)" ng-class="{'leaflet-active' : routingType == '4WD' }" uib-tooltip="{{resources.fourWheelDriveRouting}}" tooltip-placement="bottom" tooltip-append-to-body="true"><img src="content/images/four-by-four.svg" alt="" /></a>
            <a class="cursor-pointer pull-left" ng-click="setRouting('None', $event)" ng-class="{'leaflet-active' : routingType == 'None' }" uib-tooltip="{{resources.straightLines}}" tooltip-placement="bottom" tooltip-append-to-body="true"><img src="content/images/none.svg" /></a>
        </div>
    </div>
</div>
